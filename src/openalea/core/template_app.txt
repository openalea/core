# This file has been automatically generated by OpenAlea version : $OPENALEA_VERSION at $DATE

# OpenAlea Application

# __name__ = $NAME
# __author__ = $AUTHOR
# __license__ = $LICENSE
# __version__ = $VERSION
# __doc__ = $DOC


def test_system():
    # Test if the system has the correct libraries

    # OpenAlea.Core
    try:
        from openalea import core
    except ImportError:
        print ("OpenAlea application need OpenAlea.Core")
        sys.exit(1)

    # QT
    try:
        from qtpy import QtGui, QtCore
        version = int(QtCore.__version__.replace('.', ''))
        if(version < 420):
            raise ImportError

    except ImportError:
        print ("OpenAlea application need QT >= 5.5")
        sys.exit(1)


# Import 
import sys
test_system()

from openalea.core import *
from openalea.core.pkgmanager import PackageManager
from qtpy import QtGui, QtCore


$FACTORY_CODE



def open_window(factory):

    dialog = QtGui.QDialog()
    widget = factory.instantiate_widget(autonomous=True)

    dialog.setAttribute(QtCore.Qt.WA_DeleteOnClose)
    widget.setParent(dialog)
    
    vboxlayout = QtGui.QVBoxLayout(dialog)
    vboxlayout.setMargin(3)
    vboxlayout.setSpacing(5)
    vboxlayout.addWidget(widget)

    dialog.setWindowTitle(factory.name)
    dialog.show()

    return dialog


def main(args):
    
    app = QtGui.QApplication(args)

    p = PackageManager()
    p.init()
    f = $FACTORY_NAME
    win = open_window(f)
    win.show()
    
    return app.exec_()



if __name__ == "__main__":

    main(sys.argv)


    

